language: cpp
compiler:
  - clang
  - gcc
os:
  - linux
  - osx
install: # misc setup that I didn't want to put in script
  - if [ $TRAVIS_OS_NAME == osx ]; then LIBNAME=libasar.dylib; else LIBNAME=libasar.so; fi
  - mkdir build tests_dll_tmp tests_app_tmp
script:
  - cd build
  - cmake -DCMAKE_BUILD_TYPE=Release ../src
  - make
  - cd ..
  # run dll test suite
  - build/asar-tests/asar-dll-test build/asar/$LIBNAME $TRAVIS_BUILD_DIR/tests dummy_rom.sfc $TRAVIS_BUILD_DIR/tests_dll_tmp
  # run app test suite
  - build/asar-tests/asar-app-test build/asar/asar-standalone $TRAVIS_BUILD_DIR/tests dummy_rom.sfc $TRAVIS_BUILD_DIR/tests_app_tmp
